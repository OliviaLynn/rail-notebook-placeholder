Demo of SED and photometry calculations with DSPS
=================================================

author: Luca Tortorelli, Andrew Hearin

last run successfully: Aug 1, 2023

This notebook demonstrates some basic usage of the DSPS library. In
particular, for a galaxy with some arbitrary star formation history,
weâ€™ll see how to calculate its restframe SED, and its absolute and
apparent magnitude in some band.

SPS calculations are based on a set of template SEDs of simple stellar
populations (SSPs). Supplying such templates is outside the planned
scope of the DSPS package, and so they will need to be retrieved from
some other library. For example, the FSPS library supplies such
templates in a convenient form.

SingleSedModeler
~~~~~~~~~~~~~~~~

The SingleSedModeler class allows the user to generate a single
rest-frame SED at the time with DSPS.

Some example galaxy properties that are required to create a single SED
model are generated via this notebook and stored into an hdf5 table. The
required galaxy properties are:

-  galaxy redshifts
-  the grid of cosmic time over which the star-formation history of
   galaxies is evaluated in units of Gyr
-  the star-formation history of galaxies in units of Msun/yr
-  galaxy metallicity at the time of observation in units of log10(Z)
-  log normal scatter of the galaxy metallicity at the time of
   observation

.. code:: ipython3

    import os
    import rail.dsps
    from rail.core.stage import RailStage
    from rail.core.data import TableHandle
    import numpy as np
    import h5py

.. code:: ipython3

    DS = RailStage.data_store
    DS.__class__.allow_overwrite = True
    
    RAIL_DSPS_DIR = os.path.abspath(os.path.join(os.path.dirname(rail.dsps.__file__), '..', '..'))
    default_rail_fsps_files_folder = os.path.join(RAIL_DSPS_DIR, 'rail', 'examples_data', 'creation_data',
                                                  'data', 'dsps_default_data')
    input_file = os.path.join(default_rail_fsps_files_folder, 'input_galaxy_properties_dsps.hdf5')

.. code:: ipython3

    n_galaxies = 100
    
    redshift = np.linspace(0.1,1.0,num=n_galaxies)
    
    gal_t_table = np.linspace(0.05, 13.8, 100) # age of the universe in Gyr
    gal_sfr_table = np.random.uniform(0, 10, gal_t_table.size) # SFR in Msun/yr
    
    gal_lgmet = -2.0 # log10(Z)
    gal_lgmet_scatter = 0.2 # lognormal scatter in the metallicity distribution function
    
    cosmic_time_grid = np.full((n_galaxies, len(gal_t_table)), gal_t_table)
    star_formation_history = np.full((n_galaxies, len(gal_sfr_table)), gal_sfr_table)
    stellar_metallicity = np.full(n_galaxies, gal_lgmet)
    stellar_metallicity_scatter = np.full(n_galaxies, gal_lgmet_scatter)
    
    with h5py.File(input_file, 'w') as h5table:
        h5table.create_dataset(name='redshifts', data=redshift)
        h5table.create_dataset(name='cosmic_time_grid', data=cosmic_time_grid)
        h5table.create_dataset(name='star_formation_history', data=star_formation_history)
        h5table.create_dataset(name='stellar_metallicity', data=stellar_metallicity)
        h5table.create_dataset(name='stellar_metallicity_scatter', data=stellar_metallicity_scatter)

.. code:: ipython3

    trainFile = os.path.join(input_file)
    training_data = DS.read_file("training_data", TableHandle, trainFile)

The user is also required to provide the template SSPs with which
rail_dsps generates its rest-frame SEDs. Leaving it blank or to a
non-existing file will lead rail_dsps to generate the default templates
from NERSC.

.. code:: ipython3

    dspssinglesedmodeler = rail.dsps.DSPSSingleSedModeler.make_stage(name='DSPSSingleSedModeler',
                                                                     ssp_templates_file=os.path.join(RAIL_DSPS_DIR,'rail/examples_data/creation_data/data/dsps_default_data/ssp_data_fsps_v3.2_lgmet_age.h5'),
                                                                     redshift_key='redshifts',
                                                                     cosmic_time_grid_key='cosmic_time_grid',
                                                                     star_formation_history_key='star_formation_history',
                                                                     stellar_metallicity_key='stellar_metallicity',
                                                                     stellar_metallicity_scatter_key='stellar_metallicity_scatter',
                                                                     restframe_sed_key='restframe_seds', default_cosmology=True)


.. parsed-literal::

      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                     Dload  Upload   Total   Spent    Left  Speed
      0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0

.. parsed-literal::

     12 58.7M   12 7431k    0     0  14.1M      0  0:00:04 --:--:--  0:00:04 14.0M

.. parsed-literal::

    100 58.7M  100 58.7M    0     0  70.1M      0 --:--:-- --:--:-- --:--:-- 70.0M


.. code:: ipython3

    dspssinglesedmodel = dspssinglesedmodeler.fit_model(input_data=training_data)


.. parsed-literal::

    Inserting handle into data store.  model_DSPSSingleSedModeler: inprogress_model_DSPSSingleSedModeler.hdf5, DSPSSingleSedModeler


.. code:: ipython3

    dspssinglesedmodel.data




.. parsed-literal::

    {'restframe_seds': array([[8.5195687e-12, 8.9661065e-12, 1.1346992e-11, ..., 3.7093216e-06,
             3.7145385e-06, 3.7187160e-06],
            [6.7365549e-12, 7.1366918e-12, 9.0077589e-12, ..., 1.5174434e-06,
             1.5195810e-06, 1.5212909e-06],
            [6.4033106e-12, 6.8409818e-12, 8.6215531e-12, ..., 7.0338433e-07,
             7.0437392e-07, 7.0516666e-07],
            ...,
            [1.0345504e-11, 1.0979701e-11, 1.3855044e-11, ..., 2.3699320e-06,
             2.3732703e-06, 2.3759401e-06],
            [1.0086021e-11, 1.0736395e-11, 1.3537996e-11, ..., 2.3799155e-06,
             2.3832652e-06, 2.3859461e-06],
            [1.0612535e-11, 1.1295093e-11, 1.4247434e-11, ..., 1.2458883e-06,
             1.2476399e-06, 1.2490428e-06]], dtype=float32),
     'redshifts': array([0.1       , 0.10909091, 0.11818182, 0.12727273, 0.13636364,
            0.14545455, 0.15454545, 0.16363636, 0.17272727, 0.18181818,
            0.19090909, 0.2       , 0.20909091, 0.21818182, 0.22727273,
            0.23636364, 0.24545455, 0.25454545, 0.26363636, 0.27272727,
            0.28181818, 0.29090909, 0.3       , 0.30909091, 0.31818182,
            0.32727273, 0.33636364, 0.34545455, 0.35454545, 0.36363636,
            0.37272727, 0.38181818, 0.39090909, 0.4       , 0.40909091,
            0.41818182, 0.42727273, 0.43636364, 0.44545455, 0.45454545,
            0.46363636, 0.47272727, 0.48181818, 0.49090909, 0.5       ,
            0.50909091, 0.51818182, 0.52727273, 0.53636364, 0.54545455,
            0.55454545, 0.56363636, 0.57272727, 0.58181818, 0.59090909,
            0.6       , 0.60909091, 0.61818182, 0.62727273, 0.63636364,
            0.64545455, 0.65454545, 0.66363636, 0.67272727, 0.68181818,
            0.69090909, 0.7       , 0.70909091, 0.71818182, 0.72727273,
            0.73636364, 0.74545455, 0.75454545, 0.76363636, 0.77272727,
            0.78181818, 0.79090909, 0.8       , 0.80909091, 0.81818182,
            0.82727273, 0.83636364, 0.84545455, 0.85454545, 0.86363636,
            0.87272727, 0.88181818, 0.89090909, 0.9       , 0.90909091,
            0.91818182, 0.92727273, 0.93636364, 0.94545455, 0.95454545,
            0.96363636, 0.97272727, 0.98181818, 0.99090909, 1.        ])}



PopulationSedModeler
~~~~~~~~~~~~~~~~~~~~

The PopulationSedModeler class works in a similar way as the
SingleSedModeler class, but allows the user to generate a population of
rest-frame SEDs using the native parallelization capabilities of jax.

.. code:: ipython3

    import os
    import rail.dsps
    from rail.core.stage import RailStage
    from rail.core.data import TableHandle
    import numpy as np
    import h5py

.. code:: ipython3

    DS = RailStage.data_store
    DS.__class__.allow_overwrite = True
    
    default_rail_fsps_files_folder = os.path.join(RAIL_DSPS_DIR, 'rail', 'examples_data', 'creation_data',
                                                  'data', 'dsps_default_data')
    input_file = os.path.join(default_rail_fsps_files_folder, 'input_galaxy_properties_dsps.hdf5')

.. code:: ipython3

    n_galaxies = 100
    
    redshift = np.linspace(0.1,1.0,num=n_galaxies)
    
    gal_t_table = np.linspace(0.05, 13.8, 100) # age of the universe in Gyr
    gal_sfr_table = np.random.uniform(0, 10, gal_t_table.size) # SFR in Msun/yr
    
    gal_lgmet = -2.0 # log10(Z)
    gal_lgmet_scatter = 0.2 # lognormal scatter in the metallicity distribution function
    
    cosmic_time_grid = np.full((n_galaxies, len(gal_t_table)), gal_t_table)
    star_formation_history = np.full((n_galaxies, len(gal_sfr_table)), gal_sfr_table)
    stellar_metallicity = np.full(n_galaxies, gal_lgmet)
    stellar_metallicity_scatter = np.full(n_galaxies, gal_lgmet_scatter)
    
    with h5py.File(input_file, 'w') as h5table:
        h5table.create_dataset(name='redshifts', data=redshift)
        h5table.create_dataset(name='cosmic_time_grid', data=cosmic_time_grid)
        h5table.create_dataset(name='star_formation_history', data=star_formation_history)
        h5table.create_dataset(name='stellar_metallicity', data=stellar_metallicity)
        h5table.create_dataset(name='stellar_metallicity_scatter', data=stellar_metallicity_scatter)

.. code:: ipython3

    trainFile = os.path.join(input_file)
    training_data = DS.read_file("training_data", TableHandle, trainFile)

.. code:: ipython3

    dspspopulationsedmodeler = rail.dsps.DSPSPopulationSedModeler.make_stage(name='DSPSPopulationSedModeler',
                                                                             ssp_templates_file=os.path.join(RAIL_DSPS_DIR,
                                                                             'rail/examples_data/creation_data/data/dsps_default_data/ssp_data_fsps_v3.2_lgmet_age.h5'),
                                                                             redshift_key='redshifts',
                                                                             cosmic_time_grid_key='cosmic_time_grid',
                                                                             star_formation_history_key='star_formation_history',
                                                                             stellar_metallicity_key='stellar_metallicity',
                                                                             stellar_metallicity_scatter_key='stellar_metallicity_scatter',
                                                                             restframe_sed_key='restframe_seds', default_cosmology=True)

.. code:: ipython3

    dspspopulationsedmodel = dspspopulationsedmodeler.fit_model(input_data=training_data)


.. parsed-literal::

    Inserting handle into data store.  model_DSPSPopulationSedModeler: inprogress_model_DSPSPopulationSedModeler.hdf5, DSPSPopulationSedModeler


.. code:: ipython3

    dspspopulationsedmodel.data




.. parsed-literal::

    {'restframe_seds': Array([[9.2207804e-12, 9.8193285e-12, 1.2391336e-11, ..., 2.6872276e-06,
             2.6910077e-06, 2.6940331e-06],
            [1.2754842e-11, 1.3567917e-11, 1.7146942e-11, ..., 4.9745580e-07,
             4.9815031e-07, 4.9870744e-07],
            [1.7459699e-11, 1.8410639e-11, 2.3314769e-11, ..., 2.9161290e-06,
             2.9202313e-06, 2.9235152e-06],
            ...,
            [2.3750002e-11, 2.4891127e-11, 3.1560470e-11, ..., 5.5037831e-06,
             5.5115302e-06, 5.5177293e-06],
            [2.3166783e-11, 2.4276896e-11, 3.0779688e-11, ..., 5.4757506e-06,
             5.4834545e-06, 5.4896191e-06],
            [2.2686674e-11, 2.3766027e-11, 3.0131602e-11, ..., 5.2366881e-06,
             5.2440541e-06, 5.2499504e-06]], dtype=float32),
     'redshifts': array([0.1       , 0.10909091, 0.11818182, 0.12727273, 0.13636364,
            0.14545455, 0.15454545, 0.16363636, 0.17272727, 0.18181818,
            0.19090909, 0.2       , 0.20909091, 0.21818182, 0.22727273,
            0.23636364, 0.24545455, 0.25454545, 0.26363636, 0.27272727,
            0.28181818, 0.29090909, 0.3       , 0.30909091, 0.31818182,
            0.32727273, 0.33636364, 0.34545455, 0.35454545, 0.36363636,
            0.37272727, 0.38181818, 0.39090909, 0.4       , 0.40909091,
            0.41818182, 0.42727273, 0.43636364, 0.44545455, 0.45454545,
            0.46363636, 0.47272727, 0.48181818, 0.49090909, 0.5       ,
            0.50909091, 0.51818182, 0.52727273, 0.53636364, 0.54545455,
            0.55454545, 0.56363636, 0.57272727, 0.58181818, 0.59090909,
            0.6       , 0.60909091, 0.61818182, 0.62727273, 0.63636364,
            0.64545455, 0.65454545, 0.66363636, 0.67272727, 0.68181818,
            0.69090909, 0.7       , 0.70909091, 0.71818182, 0.72727273,
            0.73636364, 0.74545455, 0.75454545, 0.76363636, 0.77272727,
            0.78181818, 0.79090909, 0.8       , 0.80909091, 0.81818182,
            0.82727273, 0.83636364, 0.84545455, 0.85454545, 0.86363636,
            0.87272727, 0.88181818, 0.89090909, 0.9       , 0.90909091,
            0.91818182, 0.92727273, 0.93636364, 0.94545455, 0.95454545,
            0.96363636, 0.97272727, 0.98181818, 0.99090909, 1.        ])}



DSPSPhotometryCreator
~~~~~~~~~~~~~~~~~~~~~

This class allows the user to generate model photometry by computing the
absolute and apparent magnitudes of galaxies from their input rest-frame
SEDs. Although DSPSPopulationSedModeler generates the rest-frame SEDs
that are needed for this class, the user can supply whatever external
SED provided that the units are in Lsun/Hz.

Generating the observed photometry with DSPS is simple and requires only
few input from the user. The required input are: - the redshift dataset
keyword of the hdf5 table containing the rest-frame SEDs output from the
DSPSPopulationSedModeler - the rest-frame SEDs dataset keyword of the
hdf5 table containing the rest-frame SEDs output from the
DSPSPopulationSedModeler - the absolute and apparent magnitudes dataset
keyword of the output hdf5 table - the folder path containing the filter
bands - the name of the filter bands in order of increasing wavelength -
the path to the SSP template files - a boolean keyword to use (True) the
default cosmology in DSPS.

If the latter keyword is set to False, then the user has to manually
provide the values of Om0, w0, wa and h in the .sample function.

.. code:: ipython3

    import os
    import rail.dsps
    from rail.core.stage import RailStage
    from rail.core.data import TableHandle

.. code:: ipython3

    DS = RailStage.data_store
    DS.__class__.allow_overwrite = True
    
    input_file = 'model_DSPSPopulationSedModeler.hdf5'

.. code:: ipython3

    trainFile = os.path.join(input_file)
    training_data = DS.read_file("training_data", TableHandle, trainFile)

.. code:: ipython3

    dspsphotometrycreator = rail.dsps.DSPSPhotometryCreator.make_stage(name='DSPSPhotometryCreator',
                                                             redshift_key='redshifts',
                                                             restframe_sed_key='restframe_seds',
                                                             absolute_mags_key='rest_frame_absolute_mags',
                                                             apparent_mags_key='apparent_mags',
                                                             filter_folder=os.path.join(RAIL_DSPS_DIR,
                                                             'rail/examples_data/creation_data/data/dsps_default_data/filters'),
                                                             instrument_name='lsst',
                                                             wavebands='u,g,r,i,z,y',
                                                             ssp_templates_file=os.path.join(RAIL_DSPS_DIR,
                                                             'rail/examples_data/creation_data/data/dsps_default_data/ssp_data_fsps_v3.2_lgmet_age.h5'),
                                                             default_cosmology=True)

.. code:: ipython3

    dspsphotometry = dspsphotometrycreator.sample(input_data=training_data)


.. parsed-literal::

    Inserting handle into data store.  output_DSPSPhotometryCreator: inprogress_output_DSPSPhotometryCreator.hdf5, DSPSPhotometryCreator


.. code:: ipython3

    dspsphotometry.data




.. parsed-literal::

    {'id': array([  1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,
             14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,
             27,  28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,
             40,  41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,
             53,  54,  55,  56,  57,  58,  59,  60,  61,  62,  63,  64,  65,
             66,  67,  68,  69,  70,  71,  72,  73,  74,  75,  76,  77,  78,
             79,  80,  81,  82,  83,  84,  85,  86,  87,  88,  89,  90,  91,
             92,  93,  94,  95,  96,  97,  98,  99, 100]),
     'rest_frame_absolute_mags': array([[-20.83057404, -21.56766319, -21.90406799, -22.03848457,
             -22.214674  , -22.35424614],
            [-20.38683319, -21.37077713, -21.73384285, -21.94730377,
             -22.12483406, -22.24183464],
            [-21.01042747, -21.70536423, -22.00895119, -22.12874985,
             -22.29537392, -22.43039131],
            [-21.11273956, -21.76886749, -22.05706787, -22.17888451,
             -22.34776306, -22.48072624],
            [-21.24800682, -21.82566643, -22.11609268, -22.18550873,
             -22.35155678, -22.50225258],
            [-21.09271431, -21.71413612, -22.02243423, -22.11178398,
             -22.28238297, -22.43086815],
            [-20.66992188, -21.4762249 , -21.82212067, -21.9823513 ,
             -22.15856171, -22.29040337],
            [-20.49094963, -21.40396118, -21.75790596, -21.94918251,
             -22.12451744, -22.24643707],
            [-20.64490128, -21.50623131, -21.83349419, -22.01579094,
             -22.18447685, -22.3023262 ],
            [-21.04605675, -21.72006798, -22.01489067, -22.1253624 ,
             -22.28837395, -22.42339325],
            [-21.2565403 , -21.83813477, -22.11856651, -22.18544197,
             -22.34630013, -22.49349403],
            [-21.15460587, -21.75451851, -22.05100632, -22.11403656,
             -22.27490425, -22.4261322 ],
            [-20.95616722, -21.63881683, -21.94499779, -22.05845261,
             -22.22481918, -22.36203575],
            [-20.98319054, -21.65023422, -21.95377922, -22.0598259 ,
             -22.22619057, -22.36581612],
            [-20.95021057, -21.62742043, -21.9336853 , -22.04185486,
             -22.20897102, -22.34863853],
            [-20.89349747, -21.58919907, -21.90071869, -22.0076313 ,
             -22.17596436, -22.31741333],
            [-20.44636726, -21.38576126, -21.71935081, -21.91436768,
             -22.08354378, -22.19819069],
            [-21.01639175, -21.70002937, -21.98263168, -22.09088516,
             -22.25065231, -22.38298607],
            [-21.07933426, -21.74323845, -22.0171051 , -22.1252079 ,
             -22.28297806, -22.41288376],
            [-21.37672043, -21.91303444, -22.17203712, -22.21634674,
             -22.37269592, -22.52252007],
            [-21.31382942, -21.85353279, -22.12335014, -22.17124557,
             -22.33088875, -22.48280334],
            [-21.24808884, -21.79121399, -22.07247353, -22.12383652,
             -22.28735733, -22.44137383],
            [-20.97365952, -21.60699844, -21.9154911 , -22.01404953,
             -22.18314171, -22.32678986],
            [-20.91613388, -21.56103706, -21.8804245 , -21.9786377 ,
             -22.14917946, -22.29522324],
            [-20.73807335, -21.46006203, -21.7935276 , -21.92826653,
             -22.10124969, -22.23754311],
            [-20.7169342 , -21.44624329, -21.78125763, -21.91689301,
             -22.08961487, -22.22561455],
            [-20.69532204, -21.43190575, -21.7683773 , -21.90254402,
             -22.07507706, -22.21166992],
            [-20.50086975, -21.33746338, -21.68614006, -21.85557747,
             -22.02866554, -22.15496254],
            [-20.56527519, -21.38286972, -21.71940041, -21.88569641,
             -22.05625725, -22.18068123],
            [-20.72971916, -21.47174644, -21.79373169, -21.92909241,
             -22.09675598, -22.22843933],
            [-20.79858017, -21.51387024, -21.82557106, -21.95339775,
             -22.11975861, -22.25150871],
            [-20.81245804, -21.51934052, -21.83112526, -21.94832802,
             -22.11411285, -22.24994469],
            [-20.64767647, -21.43321991, -21.75411606, -21.89972305,
             -22.06650162, -22.19426727],
            [-20.67587662, -21.45736504, -21.77049828, -21.91312408,
             -22.07788467, -22.20458031],
            [-20.70995903, -21.48612022, -21.79110146, -21.93185616,
             -22.09461594, -22.21978951],
            [-20.77334785, -21.53322792, -21.82768059, -21.96599388,
             -22.12608719, -22.2490921 ],
            [-20.98678398, -21.65655899, -21.9347744 , -22.03683472,
             -22.1940403 , -22.32589531],
            [-21.03575325, -21.6901722 , -21.96205139, -22.06448555,
             -22.2205143 , -22.3506031 ],
            [-21.24821472, -21.81078911, -22.07301521, -22.12950516,
             -22.28450584, -22.42911911],
            [-21.2345047 , -21.79169083, -22.05744171, -22.11467552,
             -22.27114868, -22.41669464],
            [-21.25029373, -21.78660774, -22.05651283, -22.10262299,
             -22.26090622, -22.41195488],
            [-21.18251419, -21.72352409, -22.00564194, -22.05073357,
             -22.21212006, -22.36676407],
            [-20.93699265, -21.56223488, -21.86478806, -21.95598602,
             -22.12155914, -22.26441383],
            [-20.88250732, -21.51812553, -21.83066177, -21.92183685,
             -22.0895462 , -22.23482132],
            [-20.59641266, -21.36118889, -21.69562912, -21.84480858,
             -22.01540375, -22.14478493],
            [-20.63457298, -21.38788223, -21.71705055, -21.86590385,
             -22.03517914, -22.16328049],
            [-20.84083366, -21.49950981, -21.81450844, -21.921978  ,
             -22.08932686, -22.22901726],
            [-20.81184959, -21.47709656, -21.79783249, -21.90620804,
             -22.07471848, -22.21551514],
            [-20.6736145 , -21.39652061, -21.73105049, -21.86131859,
             -22.03175735, -22.16769981],
            [-20.63837433, -21.37526894, -21.71413231, -21.84410667,
             -22.01498413, -22.15185547],
            [-20.11517525, -21.13048553, -21.51115036, -21.7254734 ,
             -21.90045357, -22.0159893 ],
            [-20.18842506, -21.18276596, -21.54911995, -21.75761795,
             -21.92869186, -22.04230309],
            [-20.31488037, -21.26113892, -21.60600281, -21.80869484,
             -21.97719765, -22.08844185],
            [-20.52989769, -21.37273598, -21.69878769, -21.86262703,
             -22.02505684, -22.14396286],
            [-20.61075783, -21.42856026, -21.74080467, -21.90112877,
             -22.06040001, -22.17691231],
            [-20.88491821, -21.57746315, -21.86977577, -21.97895241,
             -22.13479424, -22.26471329],
            [-20.9064312 , -21.59235382, -21.88127518, -21.98979187,
             -22.14464378, -22.27376938],
            [-21.0968895 , -21.70291328, -21.97857857, -22.0494957 ,
             -22.20242119, -22.34221077],
            [-21.07648468, -21.68451309, -21.96294212, -22.03323364,
             -22.1867485 , -22.32749176],
            [-21.03446007, -21.65103149, -21.93506622, -22.00341034,
             -22.15718651, -22.29969597],
            [-20.8911953 , -21.56635857, -21.85816956, -21.95466042,
             -22.11003685, -22.24420738],
            [-20.86679077, -21.55037689, -21.84366608, -21.93888664,
             -22.09438705, -22.22942162],
            [-20.55517387, -21.39027405, -21.70133209, -21.85390282,
             -22.01079559, -22.12880135],
            [-20.60296059, -21.42711639, -21.72886086, -21.87862396,
             -22.03312492, -22.14959908],
            [-20.68533325, -21.48526955, -21.77410889, -21.92094803,
             -22.07312775, -22.18756676],
            [-20.93867874, -21.62555885, -21.89844704, -21.99554253,
             -22.14466667, -22.27292442],
            [-20.95461464, -21.63951492, -21.90924454, -22.00608444,
             -22.15422058, -22.28156853],
            [-21.00014687, -21.67233849, -21.93519402, -22.03103638,
             -22.17881775, -22.30498314],
            [-21.05070305, -21.70139694, -21.96253014, -22.04416084,
             -22.19003677, -22.3203907 ],
            [-21.0661087 , -21.71300888, -21.97120285, -22.05197716,
             -22.19685173, -22.32654381],
            [-21.14442635, -21.75998688, -22.01267242, -22.07855225,
             -22.22231674, -22.35603333],
            [-21.14945412, -21.76247406, -22.01394653, -22.07964134,
             -22.22283745, -22.35607338],
            [-21.16538811, -21.77252769, -22.02146339, -22.08660316,
             -22.229002  , -22.36156464],
            [-21.28425789, -21.84159088, -22.08540535, -22.12295532,
             -22.26463509, -22.4061718 ],
            [-21.26779747, -21.82499695, -22.07060623, -22.10741997,
             -22.24938965, -22.39154625],
            [-21.24094391, -21.80017281, -22.04919434, -22.08459282,
             -22.22701073, -22.37042618],
            [-21.11833763, -21.72110939, -21.97606277, -22.03614807,
             -22.17918968, -22.31457329],
            [-21.11763954, -21.7183342 , -21.97280884, -22.032341  ,
             -22.17516327, -22.31059456],
            [-21.12067795, -21.71762276, -21.97099876, -22.03012276,
             -22.17287827, -22.30829811],
            [-21.17111397, -21.74329948, -21.99450111, -22.03960991,
             -22.18220139, -22.32245445],
            [-21.15570641, -21.7280407 , -21.98053169, -22.02490616,
             -22.1678524 , -22.30884361],
            [-21.13456345, -21.70890808, -21.96373558, -22.00714111,
             -22.15059471, -22.29263687],
            [-21.06529808, -21.66180801, -21.92086601, -21.97426987,
             -22.11838722, -22.25771904],
            [-21.04209709, -21.64323235, -21.90376472, -21.95572472,
             -22.10012817, -22.2403965 ],
            [-20.99817085, -21.61052895, -21.87563896, -21.92553711,
             -22.07056236, -22.21267319],
            [-20.53570175, -21.35956955, -21.64935493, -21.78572273,
             -21.93245125, -22.04770088],
            [-20.56781578, -21.38739777, -21.66973305, -21.80334473,
             -21.94792938, -22.06196404],
            [-20.60383224, -21.4171772 , -21.69122505, -21.82204056,
             -21.96436501, -22.07698441],
            [-20.65266418, -21.45378494, -21.71846771, -21.84596252,
             -21.98640442, -22.09784698],
            [-20.71995735, -21.49896049, -21.75460434, -21.87351227,
             -22.01110649, -22.12280273],
            [-20.77755356, -21.54115295, -21.7875824 , -21.90387917,
             -22.03913307, -22.14903831],
            [-20.86877632, -21.60445213, -21.83770561, -21.95209122,
             -22.08546829, -22.19293022],
            [-21.23652267, -21.81777382, -22.03657341, -22.07341576,
             -22.20480537, -22.33758926],
            [-21.24464035, -21.82231331, -22.03915596, -22.07563591,
             -22.20657921, -22.33891869],
            [-21.26029968, -21.83299255, -22.04764175, -22.08459663,
             -22.21513748, -22.34663963],
            [-21.31398201, -21.86838913, -22.07563782, -22.11692047,
             -22.25194168, -22.38254356],
            [-21.43237495, -21.93725395, -22.14637947, -22.14606667,
             -22.27674484, -22.42153358],
            [-21.41980171, -21.92299652, -22.13355446, -22.13310051,
             -22.26443863, -22.40984154],
            [-21.40571785, -21.90744972, -22.11961365, -22.11878014,
             -22.25069237, -22.39676857],
            [-21.37104225, -21.87858963, -22.09288979, -22.09674072,
             -22.22925377, -22.3741684 ]]),
     'apparent_mags': array([[17.7478981 , 16.88811302, 16.54613686, 16.2702446 , 16.17596054,
             16.04253387],
            [18.4978199 , 17.35448837, 16.87125206, 16.65308189, 16.4635601 ,
             16.34166527],
            [17.94717598, 17.15962029, 16.79885483, 16.55914497, 16.47771645,
             16.3595314 ],
            [17.9929409 , 17.27495956, 16.90805435, 16.68453407, 16.6032505 ,
             16.48227501],
            [18.00475693, 17.38577461, 17.02073288, 16.77820015, 16.76394844,
             16.64542007],
            [18.32938004, 17.67838478, 17.26489067, 17.01801109, 16.99217987,
             16.86875725],
            [18.98053551, 18.12607956, 17.6085434 , 17.37141609, 17.2673893 ,
             17.1333313 ],
            [19.36623192, 18.37600708, 17.8061676 , 17.58662796, 17.4394474 ,
             17.30200577],
            [19.30616379, 18.39541054, 17.84745026, 17.62716484, 17.50337982,
             17.37017822],
            [18.9353199 , 18.25775909, 17.78223038, 17.55321503, 17.51642799,
             17.39374352],
            [18.80076599, 18.23282242, 17.79219818, 17.55535889, 17.57442093,
             17.45573235],
            [19.03972244, 18.45295143, 17.98102379, 17.72998428, 17.75919151,
             17.63908005],
            [19.37578964, 18.72171402, 18.19327545, 17.95257568, 17.92592621,
             17.79369926],
            [19.44681168, 18.81880951, 18.28569221, 18.0452137 , 18.02800941,
             17.89337921],
            [19.58879471, 18.95969772, 18.40520668, 18.17035484, 18.13777924,
             18.00756073],
            [19.77046013, 19.11926842, 18.53630638, 18.32252312, 18.23840141,
             18.13557053],
            [20.51522446, 19.5649128 , 18.82191658, 18.5968647 , 18.46657372,
             18.31587219],
            [19.81012917, 19.19880295, 18.61117172, 18.46718788, 18.28679085,
             18.23631096],
            [19.8073597 , 19.23874283, 18.65451431, 18.53318214, 18.30954742,
             18.28920364],
            [19.51554871, 19.07703018, 18.56516457, 18.51886177, 18.19412804,
             18.28728104],
            [19.65958977, 19.23210144, 18.70119476, 18.65099907, 18.31831169,
             18.41384125],
            [19.80519295, 19.38770676, 18.83779526, 18.78331566, 18.44078064,
             18.54047775],
            [20.21545982, 19.7330761 , 19.10022926, 18.99187088, 18.68869591,
             18.72792435],
            [20.36799431, 19.87811852, 19.21863556, 19.10538483, 18.79371643,
             18.84249878],
            [20.67675972, 20.12941742, 19.39896011, 19.23958206, 18.96825027,
             18.96719551],
            [20.77910233, 20.23523712, 19.48337173, 19.32307243, 19.05069351,
             19.05315208],
            [20.8865757 , 20.34167862, 19.56648636, 19.40768814, 19.13185692,
             19.13948059],
            [21.26933479, 20.61784172, 19.74071121, 19.53344727, 19.29858971,
             19.2584362 ],
            [21.23918152, 20.63516426, 19.76207542, 19.56199646, 19.33095741,
             19.29592896],
            [21.05753708, 20.54896736, 19.73267937, 19.56409836, 19.31118393,
             19.31395531],
            [21.01344681, 20.55363655, 19.76495743, 19.58886528, 19.34685898,
             19.34897041],
            [21.06194305, 20.61602402, 19.82732964, 19.63771057, 19.39892387,
             19.4112606 ],
            [21.38666534, 20.87019348, 19.99279213, 19.75597954, 19.55512047,
             19.51196861],
            [21.41361618, 20.91655922, 20.03786087, 19.78518677, 19.61338425,
             19.51559067],
            [21.42848206, 20.95386696, 20.07560539, 19.81027222, 19.66832352,
             19.5194397 ],
            [21.3901844 , 20.95400238, 20.08988571, 19.82238007, 19.70769691,
             19.53650665],
            [21.11612129, 20.77916718, 20.02484894, 19.75786591, 19.6910305 ,
             19.46797562],
            [21.08821487, 20.78476334, 20.04855537, 19.78088188, 19.71538353,
             19.4863472 ],
            [20.83239746, 20.60352898, 19.98703003, 19.70755196, 19.69394875,
             19.38488388],
            [20.88247681, 20.67203712, 20.06430626, 19.7713871 , 19.76198006,
             19.45228386],
            [20.89165306, 20.70651817, 20.12540817, 19.81900978, 19.82522964,
             19.48753548],
            [21.01145744, 20.83260918, 20.25042343, 19.92249298, 19.93203735,
             19.5848999 ],
            [21.37813759, 21.16009521, 20.48423004, 20.13079834, 20.09001923,
             19.7989006 ],
            [21.49444962, 21.27639389, 20.59220886, 20.21753502, 20.17631721,
             19.88842201],
            [21.98499107, 21.67028427, 20.83703041, 20.42365837, 20.31658363,
             20.10566139],
            [21.96387482, 21.67387009, 20.86309814, 20.44495964, 20.33987427,
             20.13881111],
            [21.67363167, 21.47416496, 20.78058052, 20.40750504, 20.31882095,
             20.08029175],
            [21.74761772, 21.55394936, 20.86513329, 20.4550705 , 20.38433838,
             20.15335083],
            [21.99632263, 21.76848793, 21.02725792, 20.57168961, 20.48514557,
             20.27832222],
            [22.09358978, 21.86532593, 21.11245537, 20.62905693, 20.54940605,
             20.34898376],
            [23.27946472, 22.65459633, 21.53282547, 20.930933  , 20.74331665,
             20.59644318],
            [23.18837357, 22.61394119, 21.52875328, 20.9251442 , 20.74629974,
             20.60270691],
            [22.92997932, 22.47594833, 21.48165703, 20.89180756, 20.72693825,
             20.58822441],
            [22.54588127, 22.2330265 , 21.37761307, 20.8130188 , 20.69939041,
             20.54859734],
            [22.44184303, 22.16769409, 21.35938454, 20.80059624, 20.69425583,
             20.54930496],
            [22.00189972, 21.84989166, 21.19554329, 20.67358398, 20.63907242,
             20.48798752],
            [21.99938965, 21.86053085, 21.22788239, 20.69984818, 20.66194725,
             20.52101898],
            [21.73517418, 21.65838814, 21.11858368, 20.62248039, 20.6119957 ,
             20.48962212],
            [21.78687096, 21.71923065, 21.18811607, 20.69327354, 20.65002823,
             20.55030823],
            [21.8753643 , 21.81185722, 21.27725029, 20.78030968, 20.69774246,
             20.62065697],
            [22.11751366, 22.0304966 , 21.45213699, 20.92276001, 20.78764534,
             20.71653748],
            [22.18856621, 22.10652924, 21.52472496, 20.98996353, 20.81952858,
             20.76926613],
            [22.79561996, 22.59798813, 21.85317993, 21.19591713, 20.99745941,
             20.90504646],
            [22.75645447, 22.57632256, 21.85936546, 21.1978817 , 20.9960537 ,
             20.91085243],
            [22.63945007, 22.49259377, 21.83206558, 21.17534828, 20.97622108,
             20.89796257],
            [22.23564148, 22.17806625, 21.64561081, 21.08045769, 20.85627365,
             20.84390068],
            [22.2432766 , 22.19370079, 21.67887878, 21.10473633, 20.87140846,
             20.86548615],
            [22.19694901, 22.16308212, 21.68217659, 21.10526848, 20.87060356,
             20.87069511],
            [22.15217972, 22.13306999, 21.67989922, 21.11524773, 20.86486244,
             20.88739586],
            [22.1579895 , 22.14506721, 21.70998573, 21.13696861, 20.88459396,
             20.90985489],
            [22.06552696, 22.07087326, 21.67488861, 21.12426376, 20.86220932,
             20.91094017],
            [22.0825882 , 22.09224701, 21.71248055, 21.15531158, 20.8900547 ,
             20.94129562],
            [22.0820713 , 22.09670639, 21.73814201, 21.18259239, 20.90994644,
             20.96519852],
            [21.93122673, 21.96744919, 21.65376282, 21.14582825, 20.85629082,
             20.95490265],
            [21.97327614, 22.01237106, 21.71007347, 21.19536018, 20.89923477,
             21.00330734],
            [22.03111076, 22.07233429, 21.77667236, 21.25820732, 20.94952583,
             21.06089973],
            [22.22895241, 22.257267  , 21.94551468, 21.3766346 , 21.07307625,
             21.14822197],
            [22.25195885, 22.28258514, 21.98353195, 21.41397476, 21.10509682,
             21.18181801],
            [22.26727104, 22.30049133, 22.01590157, 21.44913292, 21.13212585,
             21.21274757],
            [22.21230316, 22.25522995, 21.99452209, 21.45460701, 21.13437462,
             21.22196198],
            [22.25159836, 22.2964077 , 22.0457859 , 21.50509644, 21.18725967,
             21.24520683],
            [22.29930305, 22.34580612, 22.1043663 , 21.55957603, 21.24706078,
             21.25635719],
            [22.41843033, 22.46078873, 22.22064018, 21.64953995, 21.34601784,
             21.29249954],
            [22.47247124, 22.51626587, 22.27859688, 21.70704269, 21.41270256,
             21.30848122],
            [22.56057358, 22.60553932, 22.36316299, 21.7797718 , 21.49232101,
             21.37327576],
            [23.41961479, 23.37924957, 22.93987656, 22.14892387, 21.77090836,
             21.63519859],
            [23.40857124, 23.37025642, 22.94277763, 22.15790558, 21.77656555,
             21.63350677],
            [23.38971901, 23.35328484, 22.93829155, 22.16274071, 21.77732086,
             21.62869453],
            [23.34064865, 23.3085041 , 22.91429901, 22.15891838, 21.7707386 ,
             21.61571121],
            [23.25677299, 23.23355293, 22.86653328, 22.14037514, 21.75620651,
             21.59646797],
            [23.1929512 , 23.17232895, 22.82747459, 22.12438774, 21.74221992,
             21.5810318 ],
            [23.05616188, 23.04217148, 22.74230957, 22.08732605, 21.70284653,
             21.54737854],
            [22.46943855, 22.51247597, 22.34223366, 21.82916641, 21.53792   ,
             21.3002491 ],
            [22.47795486, 22.52041626, 22.35757637, 21.86177254, 21.55781555,
             21.33304977],
            [22.47421646, 22.51600456, 22.36286736, 21.88508606, 21.57086372,
             21.34583664],
            [22.39960861, 22.44296455, 22.31804657, 21.87296867, 21.55556297,
             21.34028435],
            [22.25445175, 22.3129425 , 22.21380234, 21.80589867, 21.52292442,
             21.27705193],
            [22.28348923, 22.34222794, 22.2495594 , 21.8495369 , 21.56132507,
             21.31441689],
            [22.31438637, 22.37343025, 22.28689575, 21.8973217 , 21.60113907,
             21.35476875],
            [22.37391281, 22.43128777, 22.3469696 , 21.96590805, 21.65301323,
             21.41716385]])}


